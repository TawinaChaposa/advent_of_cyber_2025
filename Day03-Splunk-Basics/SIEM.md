# Day 03 – Incident Investigation Using Splunk

## Scenario Overview
The city of Wareville was preparing for Christmas when the Security Operations Center (SOC) detected a critical alert on their monitoring dashboard. A ransomware message appeared, claiming responsibility for an attack on The Best Festival Company (TBFC). The attacker, King Malhare of HopSec Island, aimed to sabotage Christmas and replace it with “EAST-mas”.

With the Chief Information Security Officer (McSkidy) missing and systems actively under attack, an immediate investigation was required to determine how the ransomware infiltrated the environment and what damage had already occurred.

## My Role
I acted as a **SOC Analyst**, responsible for investigating the incident using a Security Information and Event Management (SIEM) platform. My objective was to analyze log data, identify the attacker’s methods, trace the attack timeline, and confirm whether ransomware execution and data exfiltration had taken place.

## Tools Used
- **Splunk SIEM**
  - Log ingestion and analysis
  - Search Processing Language (SPL)
  - Timeline visualization
  - Event correlation
- **Web traffic logs**
- **Firewall logs**

## Investigation Approach
I began by exploring all available logs within the Splunk environment to understand normal versus abnormal activity. Using Splunk’s search and visualization capabilities, I identified periods of unusually high traffic that indicated a potential attack window.

Next, I filtered web traffic logs to remove legitimate browser activity, allowing me to focus on suspicious automated requests generated by attacker tools. From there, I pivoted on a single malicious IP address and traced the attacker’s actions step-by-step, from reconnaissance to exploitation.

I then correlated web activity with firewall logs to confirm outbound command-and-control (C2) communication and quantify data exfiltration from the compromised server.

## Key Findings
- A single external IP address was responsible for the majority of malicious web requests.
- The attacker conducted reconnaissance using tools such as `curl` and `wget` to probe exposed configuration files.
- Path traversal and vulnerability scanning attempts were observed, indicating enumeration activity.
- SQL injection attacks were identified through known attack tools and payloads, including time-based injection techniques.
- A web shell was successfully deployed, enabling remote command execution.
- A ransomware binary was executed on the server, confirming system compromise.
- Firewall logs confirmed outbound C2 communication and significant data transfer from the compromised host.

## Outcome
The investigation confirmed a full attack lifecycle:
- Initial reconnaissance
- Vulnerability exploitation
- Remote code execution
- Ransomware deployment
- Data exfiltration via C2 communication

This analysis demonstrated how correlated log analysis can reconstruct an attack timeline and provide actionable evidence during an incident response.

## Useful Queries & Commands

<img width="606" height="340" alt="image" src="https://github.com/user-attachments/assets/9ba808ad-bbd4-4438-92d6-af3e312de6f6" />

## Skills & Concepts Learned
- Practical use of Splunk for security investigations
- Writing and refining SPL queries
- Log correlation between web and firewall data
- Identifying attack stages from raw logs
- Detecting reconnaissance, exploitation, and ransomware activity
- Thinking like a SOC analyst during real-world incidents

