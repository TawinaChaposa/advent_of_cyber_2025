#Day 06 – Malware Analysis Using Sandboxes

##Scenario Overview

In the early hours of the morning, while Wareville slept, the Security Operations Center (SOC) at The Best Festival Company (TBFC) received a suspicious internal email from Elf McClause, Head of Elf Affairs. The email contained an unexpected executable attachment, HopHelper.exe, claiming to be a new rota management tool.

Given the unusual timing and the nature of the attachment, the SOC suspected a potential malware delivery attempt. With McSkidy still missing, Elf McBlue initiated a malware investigation to determine whether the executable posed a threat to TBFC systems.

##My Role

I acted as a Malware Analyst within the SOC, responsible for safely analysing a suspicious Windows executable. My objective was to determine the file’s behaviour, identify persistence mechanisms, uncover any network communication, and extract indicators of compromise (IOCs) that could be used for detection and defence.

##Tools Used

- PeStudio (static malware analysis)
- Regshot (registry change detection)
- ProcMon / Process Monitor (dynamic behaviour analysis)
- Windows sandbox / virtual machine environment

##Investigation Approach

The investigation followed standard malware analysis methodology, beginning with static analysis to gather intelligence without executing the sample. This included extracting file hashes, reviewing embedded strings, and analysing imported libraries to understand potential functionality.

Once static analysis was complete, I proceeded with dynamic analysis inside an isolated sandbox environment. Registry snapshots were taken before and after execution to detect persistence mechanisms. Process Monitor was then used to observe file system activity, registry modifications, and network communication initiated by the sample.

#Key Findings

##Static Analysis

- The SHA256 hash of the executable was extracted for threat intelligence tracking.
- Embedded strings revealed a hidden flag and indicated suspicious functionality.
- The file appeared designed to blend in as a legitimate internal utility.

##Dynamic Analysis

- The executable modified a Windows Run registry key to establish persistence.
- Registry changes confirmed the malware would execute on system startup.
- Network activity showed outbound HTTP communication, indicating command-and-control behaviour.

##Outcome

The analysis confirmed that HopHelper.exe was a malicious executable designed to maintain persistence and communicate with an external server. By safely analysing the sample within a sandbox, I was able to extract indicators of compromise and understand the malware’s behaviour without risking production systems.

This investigation reinforced the importance of cautious email handling, sandboxing unknown binaries, and layered detection techniques within a SOC environment.

##Useful Analysis Techniques & Indicators

<img width="612" height="145" alt="image" src="https://github.com/user-attachments/assets/ff6fefdb-0d12-4524-b17c-8e62aafd006b" />

##Skills & Concepts Learned

- Principles of malware analysis
- Static vs dynamic analysis techniques
- Safe use of sandbox environments
- Identifying persistence via Windows registry keys
- Analysing process and network behaviour with ProcMon
- Translating malware behaviour into defensive intelligence
