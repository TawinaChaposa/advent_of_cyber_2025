#Day 05 – IDOR Exploitation & Authorization Bypass

##Scenario Overview

The elves of Wareville detected suspicious voucher abuse on the TryPresentMe website, alongside targeted phishing campaigns. A suspicious account, Sir Carrotbane, was discovered with access to multiple vouchers. After the account was removed, concerns remained that deeper authorization flaws existed within the application.

##My Role

I acted as a Web Security Analyst tasked with investigating authentication and authorization mechanisms within the application. My goal was to identify and exploit Insecure Direct Object Reference (IDOR) vulnerabilities and assess how improper access controls could lead to horizontal privilege escalation.

##Tools Used

- Web browser developer tools
- Network request inspection
- Local storage manipulation
- Base64 decoding
- Hash identification techniques
- UUID analysis

##Investigation Approach

I analyzed network requests generated by authenticated users to understand how object references were handled by the backend. By modifying object identifiers in client-side storage and requests, I tested whether the application properly enforced authorization checks.

I then explored progressively more hidden IDOR patterns, including encoded identifiers, hashed references, and time-based UUID generation, to determine how predictable object references could be abused.

##Key Findings

- User identity was determined by a client-controlled user ID without server-side validation.
- Modifying object references allowed access to other users’ data (horizontal privilege escalation).
- Encoded and hashed identifiers did not prevent IDOR when authorization checks were missing.
- UUID version 1 vouchers were predictable and could be brute-forced given timing information.

##Outcome

The investigation confirmed multiple authorization bypass vulnerabilities. These flaws allowed unauthorized access to sensitive user data and voucher resources. Proper server-side authorization checks and secure object ownership validation were required to remediate the issues.

##Useful Techniques & Indicators 

<img width="603" height="123" alt="image" src="https://github.com/user-attachments/assets/886fe75a-b81d-416f-8325-86ad2dc884df" />

##Skills & Concepts Learned

- Authentication vs authorization in web applications
- Identification and exploitation of IDOR vulnerabilities
- Horizontal privilege escalation techniques
- Secure design principles for access control
- Thinking like both an attacker and a defender
